{
  "version": 3,
  "sources": [],
  "sections": [
    {"offset": {"line": 6, "column": 0}, "map": {"version":3,"sources":["turbopack://[next]/internal/font/google/inter_92243eee.module.css [app-client] (css module)"],"sourcesContent":["__turbopack_export_value__({\n  \"className\": \"inter_92243eee-module__hBCtSW__className\",\n});\n"],"names":[],"mappings":"AAAA;AACA;AACA","ignoreList":[0]}},
    {"offset": {"line": 9, "column": 0}, "map": {"version":3,"sources":[],"names":[],"mappings":"A"}},
    {"offset": {"line": 15, "column": 0}, "map": {"version":3,"sources":["turbopack://[next]/internal/font/google/inter_92243eee.js"],"sourcesContent":["import cssModule from \"@vercel/turbopack-next/internal/font/google/cssmodule.module.css?{%22path%22:%22layout.js%22,%22import%22:%22Inter%22,%22arguments%22:[{%22subsets%22:[%22latin%22]}],%22variableName%22:%22inter%22}\";\nconst fontData = {\n    className: cssModule.className,\n    style: {\n        fontFamily: \"'Inter', 'Inter Fallback'\",\n        fontStyle: \"normal\",\n\n    },\n};\n\nif (cssModule.variable != null) {\n    fontData.variable = cssModule.variable;\n}\n\nexport default fontData;\n"],"names":[],"mappings":";;;AAAA;;AACA,MAAM,WAAW;IACb,WAAW,wJAAA,CAAA,UAAS,CAAC,SAAS;IAC9B,OAAO;QACH,YAAY;QACZ,WAAW;IAEf;AACJ;AAEA,IAAI,wJAAA,CAAA,UAAS,CAAC,QAAQ,IAAI,MAAM;IAC5B,SAAS,QAAQ,GAAG,wJAAA,CAAA,UAAS,CAAC,QAAQ;AAC1C;uCAEe","ignoreList":[0]}},
    {"offset": {"line": 31, "column": 0}, "map": {"version":3,"sources":[],"names":[],"mappings":"A"}},
    {"offset": {"line": 87, "column": 0}, "map": {"version":3,"sources":["file://C%3A/Users/anaru/Downloads/autenticacion_tema8/autenticacion_tema8/src/lib/prisma.js"],"sourcesContent":["import { PrismaClient } from \"@prisma/client\";\n\nexport const prisma = globalThis.prisma || new PrismaClient()\n\nif (process.env.NODE_ENV !== 'production') globalThis.prisma = prisma"],"names":[],"mappings":";;;AAAA;;AAEO,MAAM,SAAS,WAAW,MAAM,IAAI,IAAI,6HAAA,CAAA,eAAY;AAE3D,wCAA2C,WAAW,MAAM,GAAG"}},
    {"offset": {"line": 94, "column": 0}, "map": {"version":3,"sources":[],"names":[],"mappings":"A"}},
    {"offset": {"line": 100, "column": 0}, "map": {"version":3,"sources":["file://C%3A/Users/anaru/Downloads/autenticacion_tema8/autenticacion_tema8/src/lib/data.js"],"sourcesContent":["import { prisma } from '@/lib/prisma'\n\nexport async function getUserById(id) {\n  const user = await prisma.user.findUnique({\n    where: { id }\n  });\n  return user\n}\n\nexport async function getUserByEmail(email) {\n  const user = await prisma.user.findUnique({\n    where: { email }\n  });\n  return user\n}"],"names":[],"mappings":";;;;AAAA;;AAEO,eAAe,YAAY,EAAE;IAClC,MAAM,OAAO,MAAM,oHAAA,CAAA,SAAM,CAAC,IAAI,CAAC,UAAU,CAAC;QACxC,OAAO;YAAE;QAAG;IACd;IACA,OAAO;AACT;AAEO,eAAe,eAAe,KAAK;IACxC,MAAM,OAAO,MAAM,oHAAA,CAAA,SAAM,CAAC,IAAI,CAAC,UAAU,CAAC;QACxC,OAAO;YAAE;QAAM;IACjB;IACA,OAAO;AACT"}},
    {"offset": {"line": 122, "column": 0}, "map": {"version":3,"sources":[],"names":[],"mappings":"A"}},
    {"offset": {"line": 128, "column": 0}, "map": {"version":3,"sources":["file://C%3A/Users/anaru/Downloads/autenticacion_tema8/autenticacion_tema8/src/auth.config.js"],"sourcesContent":["import Google from \"@auth/core/providers/google\"\nimport GitHub from '@auth/core/providers/github'\nimport Discord from '@auth/core/providers/discord'\nimport Credentials from \"@auth/core/providers/credentials\"\nimport { getUserByEmail } from \"@/lib/data\"\n\nexport default {\n    providers: [\n        Google,\n        GitHub,\n        Discord,\n        Credentials({\n            async authorize(credentials) {\n                console.log('AUTHORIZE')\n                const user = await getUserByEmail(credentials.email)\n                return user\n            },\n        }),\n    ]\n}\n"],"names":[],"mappings":";;;AAAA;AACA;AACA;AACA;AACA;;;;;;uCAEe;IACX,WAAW;QACP,qJAAA,CAAA,UAAM;QACN,qJAAA,CAAA,UAAM;QACN,sJAAA,CAAA,UAAO;QACP,CAAA,GAAA,0JAAA,CAAA,UAAW,AAAD,EAAE;YACR,MAAM,WAAU,WAAW;gBACvB,QAAQ,GAAG,CAAC;gBACZ,MAAM,OAAO,MAAM,CAAA,GAAA,kHAAA,CAAA,iBAAc,AAAD,EAAE,YAAY,KAAK;gBACnD,OAAO;YACX;QACJ;KACH;AACL"}},
    {"offset": {"line": 155, "column": 0}, "map": {"version":3,"sources":[],"names":[],"mappings":"A"}},
    {"offset": {"line": 161, "column": 0}, "map": {"version":3,"sources":["file://C%3A/Users/anaru/Downloads/autenticacion_tema8/autenticacion_tema8/src/auth.js"],"sourcesContent":["import NextAuth from \"next-auth\"\nimport { prisma } from \"@/lib/prisma\"\nimport { PrismaAdapter } from \"@auth/prisma-adapter\";\nimport { getUserById } from \"@/lib/data\"\nimport authConfig from \"@/auth.config\"\n\n\nexport const options = {\n    session: { strategy: 'jwt' },\n    adapter: PrismaAdapter(prisma),\n    pages: {\n        signIn: '/auth/login',\n        signOut: '/auth/logout',\n        error: '/auth/error'\n    },\n    events: {\n        async linkAccount({ user }) {\n            await prisma.user.update({\n                where: { id: user.id },\n                data: { emailVerified: new Date() }\n            })\n        }\n    },\n    callbacks: {\n        async session({ session, token }) {\n            session.user.id = token?.sub;     // Para recuperar ID de usuario desde el token\n            session.user.role = token?.role   // Para recuperar rol de usuario desde el token\n            return session\n        },\n\n        async jwt({ token }) {\n            if (!token.sub) return token;\n\n            const user = await getUserById(token.sub)\n            if (!user) return token;\n\n            token.role = user?.role\n            return token\n        }\n    },\n}\n\n\n\nexport const {\n    handlers: { GET, POST },\n    auth,\n    signIn,\n    signOut\n} = NextAuth({ ...options, ...authConfig })\n"],"names":[],"mappings":";;;;;;;;AAAA;AACA;AACA;AACA;AACA;AAJA;;;;;;AAOO,MAAM,UAAU;IACnB,SAAS;QAAE,UAAU;IAAM;IAC3B,SAAS,CAAA,GAAA,oJAAA,CAAA,gBAAa,AAAD,EAAE,oHAAA,CAAA,SAAM;IAC7B,OAAO;QACH,QAAQ;QACR,SAAS;QACT,OAAO;IACX;IACA,QAAQ;QACJ,MAAM,aAAY,EAAE,IAAI,EAAE;YACtB,MAAM,oHAAA,CAAA,SAAM,CAAC,IAAI,CAAC,MAAM,CAAC;gBACrB,OAAO;oBAAE,IAAI,KAAK,EAAE;gBAAC;gBACrB,MAAM;oBAAE,eAAe,IAAI;gBAAO;YACtC;QACJ;IACJ;IACA,WAAW;QACP,MAAM,SAAQ,EAAE,OAAO,EAAE,KAAK,EAAE;YAC5B,QAAQ,IAAI,CAAC,EAAE,GAAG,OAAO,KAAS,8CAA8C;YAChF,QAAQ,IAAI,CAAC,IAAI,GAAG,OAAO,KAAO,+CAA+C;;YACjF,OAAO;QACX;QAEA,MAAM,KAAI,EAAE,KAAK,EAAE;YACf,IAAI,CAAC,MAAM,GAAG,EAAE,OAAO;YAEvB,MAAM,OAAO,MAAM,CAAA,GAAA,kHAAA,CAAA,cAAW,AAAD,EAAE,MAAM,GAAG;YACxC,IAAI,CAAC,MAAM,OAAO;YAElB,MAAM,IAAI,GAAG,MAAM;YACnB,OAAO;QACX;IACJ;AACJ;AAIO,MAAM,EACT,UAAU,EAAE,GAAG,EAAE,IAAI,EAAE,EACvB,IAAI,EACJ,MAAM,EACN,OAAO,EACV,GAAG,CAAA,GAAA,qJAAA,CAAA,UAAQ,AAAD,EAAE;IAAE,GAAG,OAAO;IAAE,GAAG,qHAAA,CAAA,UAAU;AAAC"}},
    {"offset": {"line": 222, "column": 0}, "map": {"version":3,"sources":[],"names":[],"mappings":"A"}},
    {"offset": {"line": 228, "column": 0}, "map": {"version":3,"sources":["file://C%3A/Users/anaru/Downloads/autenticacion_tema8/autenticacion_tema8/src/lib/actions.js"],"sourcesContent":["'use server'\nimport bcrypt from 'bcryptjs'\nimport { prisma } from '@/lib/prisma'\nimport { signIn, signOut } from '@/auth';\nimport { getUserByEmail } from '@/lib/data';\n\n\n// REGISTER\nexport async function register(prevState, formData) {\n    const name = formData.get('name')\n    const email = formData.get('email')\n    const password = formData.get('password')\n\n    // Comprobamos si el usuario ya est치 registrado\n    const user = await getUserByEmail(email);\n\n    if (user) {\n        return {\n            error: 'El email ya est치 registrado',\n            fields: Object.fromEntries(formData.entries())\n        }\n    }\n\n    // Encriptamos password \n    const hashedPassword = await bcrypt.hash(password, 10)\n\n    // Guardamos credenciales en base datos\n    await prisma.user.create({\n        data: {\n            name,\n            email,\n            password: hashedPassword\n        }\n    })\n\n    return { success: \"Registro correcto\" }\n}\n\n\n\n// LOGIN credentials\nexport async function login(prevState, formData) {\n    const email = formData.get('email')\n    const password = formData.get('password')\n\n    // Comprobamos si el usuario est치 registrado\n    const user = await getUserByEmail(email);\n\n    if (!user) {\n        return {\n            error: 'Usuario no registrado.',\n            fields: Object.fromEntries(formData.entries())\n        }\n    }\n\n    // Comparamos password \n    const matchPassword = await bcrypt.compare(password, user.password)\n\n    if (user && matchPassword) {  // && user.emailVerified\n        await signIn('credentials',\n            {\n                email, password,\n                redirectTo: globalThis.callbackUrl\n            })\n        return { success: \"Inicio de sesi칩n correcto\" }\n    } else {\n        return {\n            error: 'Credenciales incorrectas.',\n            fields: Object.fromEntries(formData.entries())\n        }\n    }\n\n}\n\n// LOGIN google\nexport async function loginGoogle() {\n    try {\n        await signIn('google', { redirectTo: globalThis.callbackUrl })\n    } catch (error) {\n        console.log(error);\n        throw error\n    }\n}\n\n// LOGIN github\nexport async function loginGithub() {\n    try {\n        await signIn('github', { redirectTo: globalThis.callbackUrl })\n    } catch (error) {\n        console.log(error);\n        throw error\n    }\n}\n\n\n// LOGIN discord\nexport async function loginDiscord() {\n    try {\n        await signIn('discord', { redirectTo: globalThis.callbackUrl })\n    } catch (error) {\n        console.log(error);\n        throw error\n    }\n}\n\n\n// LOGIN resend (Magic Link to email)\nexport async function loginResend(formData) {\n    try {\n        await signIn(\"resend\", formData)\n    } catch (error) {\n        console.log(error);\n        throw error\n    }\n}\n\n\n\n// LOGOUT\nexport async function logout() {\n    try {\n        await signOut({ redirectTo: '/' })\n    } catch (error) {\n        throw error\n    }\n}\n"],"names":[],"mappings":"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"}},
    {"offset": {"line": 369, "column": 0}, "map": {"version":3,"sources":[],"names":[],"mappings":"A"}},
    {"offset": {"line": 375, "column": 0}, "map": {"version":3,"sources":["file://C%3A/Users/anaru/Downloads/autenticacion_tema8/autenticacion_tema8/src/components/header.js"],"sourcesContent":["import Link from 'next/link'\nimport { auth } from \"@/auth\"\nimport { logout } from '@/lib/actions'\nimport { Home } from 'lucide-react';\n\n\nasync function Header() {\n    const session = await auth();\n    // console.log(session);\n\n    return (\n        <header className='bg-blue-700 text-white flex px-10 py-2 justify-between items-center'>\n            <nav className='flex gap-4 items-center'>\n                <Link href=\"/\">\n                    <Home />\n                </Link>\n                {session?.user?.role === 'ADMIN'\n                    && <Link href=\"/admin\">Admin panel</Link>\n                }\n                <Link href=\"/dashboard\">Dashboard</Link>\n                <Link href=\"/about\">About</Link>\n            </nav>\n            <div className='flex gap-4'>\n                {session\n                    ? <form><button formAction={logout}>Logout</button></form>\n                    : <Link href=\"/auth/login\">Login</Link>\n                }\n            </div>\n        </header>\n    )\n}\n\nexport default Header"],"names":[],"mappings":";;;;AAAA;AACA;AACA;AACA;;;;;;AAGA,eAAe;IACX,MAAM,UAAU,MAAM,CAAA,GAAA,2GAAA,CAAA,OAAI,AAAD;IACzB,wBAAwB;IAExB,qBACI,8OAAC;QAAO,WAAU;;0BACd,8OAAC;gBAAI,WAAU;;kCACX,8OAAC,4JAAA,CAAA,UAAI;wBAAC,MAAK;kCACP,cAAA,8OAAC,mMAAA,CAAA,OAAI;;;;;;;;;;oBAER,SAAS,MAAM,SAAS,yBAClB,8OAAC,4JAAA,CAAA,UAAI;wBAAC,MAAK;kCAAS;;;;;;kCAE3B,8OAAC,4JAAA,CAAA,UAAI;wBAAC,MAAK;kCAAa;;;;;;kCACxB,8OAAC,4JAAA,CAAA,UAAI;wBAAC,MAAK;kCAAS;;;;;;;;;;;;0BAExB,8OAAC;gBAAI,WAAU;0BACV,wBACK,8OAAC;8BAAK,cAAA,8OAAC;wBAAO,YAAY,qHAAA,CAAA,SAAM;kCAAE;;;;;;;;;;yCAClC,8OAAC,4JAAA,CAAA,UAAI;oBAAC,MAAK;8BAAc;;;;;;;;;;;;;;;;;AAK/C;uCAEe"}},
    {"offset": {"line": 475, "column": 0}, "map": {"version":3,"sources":[],"names":[],"mappings":"A"}},
    {"offset": {"line": 481, "column": 0}, "map": {"version":3,"sources":["file://C%3A/Users/anaru/Downloads/autenticacion_tema8/autenticacion_tema8/src/app/layout.js"],"sourcesContent":["import '@/app/globals.css'\nimport { Inter } from 'next/font/google'\nimport Header from '@/components/header'\n\n\nconst inter = Inter({ subsets: ['latin'] })\n\nexport const metadata = {\n  title: 'Authjs 5: Middleware',\n  description: 'Generated by create next app',\n}\n\nexport default async function RootLayout({ children }) {\n\n\n  return (\n    <html lang=\"es\">\n      <body className={`bg-slate-100 ${inter.className}`} >\n        <Header />\n        <main className=\"md:px-10\">\n          {children}\n        </main>\n      </body>\n    </html>\n  )\n}\n"],"names":[],"mappings":";;;;;;AAEA;;;;;AAKO,MAAM,WAAW;IACtB,OAAO;IACP,aAAa;AACf;AAEe,eAAe,WAAW,EAAE,QAAQ,EAAE;IAGnD,qBACE,8OAAC;QAAK,MAAK;kBACT,cAAA,8OAAC;YAAK,WAAW,CAAC,aAAa,EAAE,yIAAA,CAAA,UAAK,CAAC,SAAS,EAAE;;8BAChD,8OAAC,2HAAA,CAAA,UAAM;;;;;8BACP,8OAAC;oBAAK,WAAU;8BACb;;;;;;;;;;;;;;;;;AAKX"}},
    {"offset": {"line": 527, "column": 0}, "map": {"version":3,"sources":[],"names":[],"mappings":"A"}}]
}